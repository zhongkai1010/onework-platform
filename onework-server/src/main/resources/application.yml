spring:
  application:
    name: onework-server # 应用名称
  main:
    allow-circular-references: true # 允许循环依赖，因为项目是三层架构，无法避免这个情况
  devtools:
    restart:
      enabled: true # 启用热部署
      additional-paths: src/main/java # 热部署监控的目录
  # Redis 配置。Redisson 默认的配置足够使用，一般不需要进行调优
  data:
    redis:
      host: 127.0.0.1 # 地址
      port: 63791 # 端口
      database: 1 # 数据库索引
  #    password: 123456 # 密码，建议生产环境开启
  # 数据源配置项
  datasource:
    druid: # Druid 【监控】相关的全局配置
      web-stat-filter:
        enabled: true
      stat-view-servlet:
        enabled: true
        allow: # 设置白名单，不填则允许所有访问
        url-pattern: /druid/*
        login-username: # 控制台管理用户名和密码
        login-password:
      filter:
        stat:
          enabled: true
          log-slow-sql: true # 慢 SQL 记录
          slow-sql-millis: 100
          merge-sql: true
        wall:
          config:
            multi-statement-allow: true
    dynamic: # 多数据源配置
      druid: # Druid 【连接池】相关的全局配置
        initial-size: 5 # 初始连接数
        min-idle: 10 # 最小连接池数量
        max-active: 20 # 最大连接池数量
        max-wait: 600000 # 配置获取连接等待超时的时间，单位：毫秒
        time-between-eviction-runs-millis: 60000 # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位：毫秒
        min-evictable-idle-time-millis: 300000 # 配置一个连接在池中最小生存的时间，单位：毫秒
        max-evictable-idle-time-millis: 900000 # 配置一个连接在池中最大生存的时间，单位：毫秒
        validation-query: SELECT 1 # 配置检测连接是否有效
        test-while-idle: true
        test-on-borrow: false
        test-on-return: false
      primary: master
      datasource:
        master:
          url: jdbc:mysql://127.0.0.1:33061/onework_platform?useSSL=false&useUnicode=true&allowPublicKeyRetrieval=true&characterEncoding=UTF-8 # 数据库连接URL
          username: root # 数据库用户名
          password: 123456 # 数据库密码
        slave: # 模拟从库，可根据自己需要修改 # 模拟从库，可根据自己需要修改
          lazy: true # 开启懒加载，保证启动速度
          url: jdbc:mysql://127.0.0.1:33061/onework_platform?useSSL=false&useUnicode=true&allowPublicKeyRetrieval=true&characterEncoding=UTF-8 # 数据库连接URL
          username: root # 数据库用户名
          password: 123456 # 数据库密码

####################################################################

springdoc: # SpringDoc配置
  api-docs:
    enabled: true # 是否启用API文档
    path: /v3/api-docs # API文档路径
  swagger-ui:
    enabled: true # 是否启用Swagger UI
    path: /swagger-ui # Swagger UI路径
    tags-sorter: alpha # 标签排序方式
    operations-sorter: alpha # 操作排序方式
  default-flat-param-object: true # 是否启用扁平化参数对象，参见 https://doc.xiaominfo.com/docs/faq/v4/knife4j-parameterobject-flat-param 文档
  group-configs: # 分组配置
    - group: "default" # 分组名称
      display-name: "测试" # 显示名称
      paths-to-match: "/**" # 匹配路径
      packages-to-scan: ${onework.info.base-package} # 扫描包路径

knife4j: # Knife4j配置
  enable: true # 是否启用
  setting:
    language: zh_cn # 语言
    enable-swagger-models: true # 是否启用Swagger Models
    enable-document-manage: true # 是否启用文档管理

####################################################################

mybatis-plus-join: # MyBatis Plus Join配置
  banner: false # 是否打印 mybatis plus join banner，默认true
  sub-table-logic: true # 全局启用副表逻辑删除，默认true。关闭后关联查询不会加副表逻辑删除
  ms-cache: true # 拦截器MappedStatement缓存，默认 true
  table-alias: t # 表别名(默认 t)
  logic-del-type: on # 副表逻辑删除条件的位置，支持 WHERE、ON，默认 ON

mybatis-plus: # MyBatis Plus配置
  configuration:
    map-underscore-to-camel-case: true # 虽然默认为 true ，但是还是显示去指定下
  global-config:
    db-config:
      id-type: ASSIGN_ID # "智能"模式，基于 IdTypeEnvironmentPostProcessor + 数据源的类型，自动适配成 AUTO、INPUT 模式
      logic-delete-value: 1 # 逻辑已删除值(默认为 1)
      logic-not-delete-value: 0 # 逻辑未删除值(默认为 0)
    banner: false # 关闭控制台的 Banner 打印
  type-aliases-package: ${onework.info.base-package}.*.*.dal.dataobject # 实体类包路径

####################################################################

onework: # OneWork配置
  info:
    base-package: com.onework.boot # 基础包路径
    version: 1.0.0 # 版本号
  xss:
    enable: true # 是否启用XSS防护
  swagger:
    title: OneWork 开发平台 # 标题
    description: 提供管理后台、用户 App 的所有功能 # 描述
    version: ${onework.info.version} # 版本
    url: https://github.com/zhongkai1010/onework-platform # 项目地址
    email: zhongkai1010@163.com # 联系邮箱
    license: MIT # 许可证
    license-url: https://github.com/zhongkai1010/onework-platform/LICENSE # 许可证地址
  security:
    mock-enable: true
  sms-code: # 短信验证码相关的配置项
    expire-times: 10m
    send-frequency: 1m
    send-maximum-quantity-per-day: 10
    begin-code: 9999 # 这里配置 9999 的原因是，测试方便。
    end-code: 9999 # 这里配置 9999 的原因是，测试方便。
